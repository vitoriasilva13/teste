<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioCalc: Peso de Peixes</title>
    <style>
        :root {
            --primary: #2563eb;
            --success: #16a34a;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        .container {
            width: 100%;
            max-width: 900px;
            display: grid;
            grid-template-columns: 1fr 1fr; /* Duas colunas */
            gap: 20px;
        }

        /* Responsividade para celular */
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
        }

        .card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        h1 { grid-column: 1 / -1; text-align: center; color: var(--primary); margin-bottom: 10px; }
        h2 { font-size: 1.2rem; margin-top: 0; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; }
        
        label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem; }
        
        textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-family: monospace;
            box-sizing: border-box; /* Importante para n√£o quebrar o layout */
        }

        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            transition: opacity 0.2s;
        }

        button:hover { opacity: 0.9; }

        .btn-calibrar { background-color: var(--primary); color: white; }
        .btn-calcular { background-color: var(--success); color: white; }

        .result-box {
            background-color: #f1f5f9;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid var(--primary);
        }

        .formula { font-style: italic; color: #64748b; font-size: 0.9rem; margin-top: 5px; }
        .destaque { font-size: 1.5rem; font-weight: bold; color: var(--success); }

    </style>
</head>
<body>

<div class="container">
    <h1>üêü Calculadora de Biomassa (W = a¬∑L·µá)</h1>

    <div class="card">
        <h2>1. Calibrar Par√¢metros</h2>
        <p class="formula">Insira os dados coletados (Comprimento, Peso), um por linha.</p>
        
        <label for="inputData">Dados de Campo (C, P):</label>
        <textarea id="inputData">
10, 15
12, 26
15, 52
20, 125
22, 160
25, 240
30, 410
32, 500
35, 650
40, 980</textarea>
        
        <button class="btn-calibrar" onclick="calibrarModelo()">Calcular "a" e "b"</button>

        <div id="resultadoCalibracao" class="result-box" style="display:none;">
            <div><strong>a (Fator Condi√ß√£o):</strong> <span id="valA">---</span></div>
            <div><strong>b (Alometria):</strong> <span id="valB">---</span></div>
            <div style="margin-top:5px; font-size:0.8rem; color:green;">Modelo Atualizado!</div>
        </div>
    </div>

    <div class="card">
        <h2>2. Estimar Peso</h2>
        <p class="formula">Use o modelo calibrado para prever o peso de novos peixes.</p>

        <label for="inputComp">Comprimento do Peixe (cm):</label>
        <input type="number" id="inputComp" placeholder="Ex: 28">

        <button class="btn-calcular" onclick="calcularPeso()">Calcular Peso</button>

        <div id="resultadoPeso" class="result-box" style="display:none;">
            <div>Peso Estimado:</div>
            <div class="destaque" id="pesoFinal">0g</div>
        </div>
    </div>
</div>

<script>
    // Vari√°veis globais para armazenar o modelo treinado
    let modeloA = null;
    let modeloB = null;

    function calibrarModelo() {
        const textoInput = document.getElementById('inputData').value;
        const linhas = textoInput.trim().split('\n');
        
        let dados = [];
        
        // Processar o texto para criar array de objetos
        for(let linha of linhas) {
            const partes = linha.split(',');
            if(partes.length === 2) {
                const L = parseFloat(partes[0]);
                const W = parseFloat(partes[1]);
                if(!isNaN(L) && !isNaN(W)) {
                    dados.push({L, W});
                }
            }
        }

        if(dados.length < 2) {
            alert("Por favor, insira pelo menos 2 linhas de dados v√°lidos.");
            return;
        }

        // --- ALGORITMO DE REGRESS√ÉO LOG-LOG ---
        let n = dados.length;
        let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0;

        for (let p of dados) {
            let x = Math.log(p.L); // ln(L)
            let y = Math.log(p.W); // ln(W)
            sumX += x;
            sumY += y;
            sumXY += (x * y);
            sumXX += (x * x);
        }

        let slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
        let intercept = (sumY - slope * sumX) / n;

        // Salvar nos globais
        modeloB = slope;
        modeloA = Math.exp(intercept);

        // Atualizar Interface
        document.getElementById('valA').innerText = modeloA.toFixed(5);
        document.getElementById('valB').innerText = modeloB.toFixed(3);
        document.getElementById('resultadoCalibracao').style.display = 'block';
    }

    function calcularPeso() {
        // Valida√ß√£o
        if (modeloA === null || modeloB === null) {
            alert("Por favor, clique em 'Calcular a e b' primeiro para treinar o modelo.");
            return;
        }

        const comp = parseFloat(document.getElementById('inputComp').value);
        
        if (isNaN(comp) || comp <= 0) {
            alert("Insira um comprimento v√°lido.");
            return;
        }

        // --- F√ìRMULA W = a * L^b ---
        const peso = modeloA * Math.pow(comp, modeloB);
        
        // Formata√ß√£o bonita
        let textoPeso = "";
        if(peso >= 1000) {
            textoPeso = (peso/1000).toFixed(3) + " kg";
        } else {
            textoPeso = peso.toFixed(1) + " g";
        }

        document.getElementById('pesoFinal').innerText = textoPeso;
        document.getElementById('resultadoPeso').style.display = 'block';
    }
</script>

</body>
</html>
<!-- 
// ============================================================
// 1. BASE DE DADOS FICT√çCIA (Dados de Campo)
// ============================================================
// Imagine que voc√™ foi ao rio, mediu e pesou 10 peixes.
// Estes dados t√™m pequenas varia√ß√µes, como na vida real.
const dadosDeCampo = [
    { L: 10, W: 15 },   // Peixe pequeno
    { L: 12, W: 26 },
    { L: 15, W: 52 },
    { L: 20, W: 125 },  // Peixe m√©dio
    { L: 22, W: 160 },
    { L: 25, W: 240 },
    { L: 30, W: 410 },  // Peixe grande
    { L: 32, W: 500 },
    { L: 35, W: 650 },
    { L: 40, W: 980 }   // O "trof√©u"
];

// ============================================================
// 2. O MOTOR ESTAT√çSTICO (C√°lculo de 'a' e 'b')
// ============================================================
function calibrarParametros(dados) {
    let n = dados.length;
    let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0;

    // Passo A: Lineariza√ß√£o (Transforma√ß√£o Log-Log)
    // X = ln(Comprimento)
    // Y = ln(Peso)
    for (let peixe of dados) {
        let x = Math.log(peixe.L); // Log natural de L
        let y = Math.log(peixe.W); // Log natural de W

        sumX += x;
        sumY += y;
        sumXY += (x * y);
        sumXX += (x * x);
    }

    // Passo B: F√≥rmulas da Regress√£o Linear (M√≠nimos Quadrados)
    // C√°lculo da inclina√ß√£o (Slope) que representa o 'b'
    let slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);

    // C√°lculo do intercepto (Intercept) que representa ln(a)
    let intercept = (sumY - slope * sumX) / n;

    // Passo C: Destransforma√ß√£o
    // O 'slope' j√° √© o 'b' direto.
    // O 'intercept' √© o ln(a), ent√£o precisamos fazer e^(intercept) para achar 'a'
    let b = slope;
    let a = Math.exp(intercept);

    return { a, b };
}

// ============================================================
// 3. FUN√á√ÉO DE PREDI√á√ÉO (Usa os 'a' e 'b' calibrados)
// ============================================================
function preverPeso(comprimento, a, b) {
    // F√≥rmula: W = a * L^b
    return a * Math.pow(comprimento, b);
}

// ============================================================
// 4. EXECU√á√ÉO
// ============================================================

console.log("--- 1. Analisando os dados de campo... ---");
const params = calibrarParametros(dadosDeCampo);

console.log(`Par√¢metros calculados para essa popula√ß√£o:`);
console.log(`a (Fator de Condi√ß√£o): ${params.a.toFixed(5)}`); // Ex: 0.014...
console.log(`b (Coeficiente de Alometria): ${params.b.toFixed(3)}`); // Ex: 3.02...

console.log("\n--- 2. Fazendo Previs√µes ---");

// Vamos estimar o peso de um peixe de 28cm (que n√£o estava na lista original)
let tamanhoAlvo = 28;
let pesoEstimado = preverPeso(tamanhoAlvo, params.a, params.b);

console.log(`Se voc√™ pescar um peixe de ${tamanhoAlvo}cm:`);
console.log(`Peso Estimado: ${pesoEstimado.toFixed(1)}g`);

// Teste de prova real (validando com um dado conhecido da lista, ex: 40cm)
let tamanhoTeste = 40;
let pesoTeste = preverPeso(tamanhoTeste, params.a, params.b);
console.log(`\nVerifica√ß√£o (40cm): Real era ~980g, Modelo previu: ${pesoTeste.toFixed(1)}g`); -->
